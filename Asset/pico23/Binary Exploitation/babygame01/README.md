# babygame01
> Write-up author: vreshco
## DESCRIPTION:
Get the flag and reach the exit. Welcome to BabyGame! Navigate around the map and see what you can find! The game is available to download here. 
There is no source available, so you'll have to figure your way around the map. You can connect with it using `nc saturn.picoctf.net 50026`.
## HINT:
- NONE
## STEPS:
1. Given a 64 bit binary file.

![image](https://user-images.githubusercontent.com/70703371/232230772-0acfca7c-312f-4936-b24e-e0805a68fd09.png)


2. Let's check the binary protections.

> VULN -> No PIE.

![image](https://user-images.githubusercontent.com/70703371/232230782-a4cb6416-96f9-47ac-bd68-bd9ddc3c9f43.png)


3. Let's decompile the binary.
4. After analyzing the main function, it looks like the `local_aac` value must be 29 and `local_aa8` value must be 89 in order to bypass the loop condition and printed out "You Win!".

![image](https://user-images.githubusercontent.com/70703371/232231583-5ccc7875-3921-4ecd-ad4a-2956194d456c.png)


5. However it's still unknown how we can make the `local_aa4` value to not null in order to get the flag.
6. Checking the move_player() function, we know that we can use several keystrokes to move the player.

![image](https://user-images.githubusercontent.com/70703371/232231939-fd789468-1f17-4623-bcfb-ad45c926e87b.png)


7. Also there's a solve_round() function which we can use by pressing **p**.
8. Pressing p shall end the round and printed "You Win!".
9. Let's run the binary.

> RESULT

![image](https://user-images.githubusercontent.com/70703371/232232278-83a1592e-a33f-42d2-bb7f-1c5573c753ae.png)


10. So it's telling us that our position is at (4,4). It will change after we move the player. The player has flag is stands for the `local_aa4` variable.
11. Confused here.. Took a while for me, until i tried to move the characters beyond the map and get segmentation fault.

> Keystrokes -> wwwwaaaaaaaaa

![image](https://user-images.githubusercontent.com/70703371/232232863-79c6a3f4-33c9-4f77-afc0-235464a7a29b.png)


12. Not only that, i realized after pressing a for the 4th time (when the player already beyond the map), `local_aa4` changed to 64.

![image](https://user-images.githubusercontent.com/70703371/232232926-01d2b20f-8cf1-4624-b8f5-6d46fb48f620.png)


13. Finally, we just need to press p to solve the round.

> RESULT

![image](https://user-images.githubusercontent.com/70703371/232233000-67d7fa03-654e-4937-8b89-864810b53eac.png)


14. We successfully get to the win() function.
15. Let's use script to send it remotely.

```py
from pwn import *
import os

os.system('clear')

def start(argv=[], *a, **kw):
    if args.REMOTE:
        return remote(sys.argv[1], sys.argv[2], *a, **kw)
    else:
        return process([exe] + argv, *a, **kw)

exe = './game'
elf = context.binary = ELF(exe, checksec=True)
context.log_level = 'debug'

sh = start()

p = flat([
    b'aaaawwwwaaaap'
])

sh.sendline(p)
sh.interactive()
```

> REMOTELY

![image](https://user-images.githubusercontent.com/70703371/232230696-3306424d-9e29-4045-8702-cdacd9cd8d6a.png)


## FLAG

```
picoCTF{gamer_m0d3_enabled_054c1d5a}
```
